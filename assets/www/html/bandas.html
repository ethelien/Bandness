<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<link rel="stylesheet" href="../css/bandas.css">
<script type='text/javascript' src='js/cordova-1.5.0.js'></script>
<script src="../js/jquery-1.7.2.min.js"></script>
<script src="../js/jquery.jsonp-2.2.1.js"></script>
<script>
    var $resultados;
    var $valor;
    var $Banda;
    var $tipo;
    var $estilo2;
    var $estilo3;
    var $name;
    var $id;

	var numero = 0;
	var landmark;
	
	$(document).ready(function() {
        $("body").css("display", "none");
  	    $("body").fadeIn('slow');
    
        document.addEventListener("deviceready", function() {console.log("PhoneGap initialized.")}, false);    
    });
	
	 
	function leerGET(){
		    var cadGET = location.search.substr(1,location.search.length);
			var arrGET = cadGET.split("&");
			var asocGET = new Array();
			var variable = "";
			var valor = "";
			for(i=0;i<arrGET.length;i++){
				 var aux = arrGET[i].split("=");
				 variable = aux[0];
				 valor = aux[1];
		 		asocGET[variable] = valor;
			}
		 return asocGET;
	} 
	
	
    function onBodyLoad() {
    	
		var paresVarValor = leerGET();
		Banda = paresVarValor['Banda'];
		tipo = paresVarValor['tipo'];
		estilo2 = paresVarValor['estilo2'];
		estilo3 = paresVarValor['estilo3'];
		obtenerDatos();
		
    }
    
	function addNewRow()
	{
	  // obtenemos acceso a la tabla por su ID
	  var TABLE = document.getElementById("bandas");
	  // obtenemos acceso a la fila maestra por su ID
	  var TROW = document.getElementById("fila");
	  // tomamos la celda
	  var content = TROW.getElementsByTagName("td");
	  // creamos una nueva fila
	  var newRow = TABLE.insertRow(-1);
	  newRow.className = TROW.attributes['class'].value;
	  // creamos una nueva celda
	  var newCell = newRow.insertCell(newRow.cells.length);
	  var newCell2 = newRow.insertCell(newRow.cells.length);

	  newCell.className = "nombres";
	  newCell2.className = "logo";
	 
	  // y lo asignamos a la celda
	  newCell.innerHTML = landmark;
	  newCell2.innerHTML = "PROBANDO";
	  newRow.idName=id;
	  newRow.onclick=function(){Cargar_Banda(newRow.idName);}
	 
	  // aviso ;)
	  //alert(txt)
	}

	function Cargar_Banda(x){
        window.open("file:///android_asset/www/html/banda.html?Banda="+x);		
	}
	
    function obtenerDatos() {
        
        $.ajax({
            //url: 'http://192.168.1.101/banda_nombre.php',
            url: 'http://192.168.1.101/localizacion.php?busqueda='+Banda+"&estilo2="+estilo2+"&estilo3="+estilo3+'&tipo='+tipo,
            dataType: 'jsonp',
            jsonp: 'jsoncallback',
            type:'get',
            timeout: 5000,
            success: function(data/*, status*/){
                $.each(data, function(i,item){
                    landmark = '<h2>'+item.name+'</h2>';
                    name=item.name;
                    id=item.id;
                    addNewRow();
                });
                //mostrardatos();
            },
            error: function(){
                alert('no va');
            }
        });
    }
    
    function mostrardatos() {
        $('#resulta').html($resultados);
        $.mobile.pageLoading(true);
    }
    
    function continuar(){
        window.open("file:///android_asset/www/html/publico_banda.html?Banda="+valor);
	}
	
	function configuracion(){
        window.open("file:///android_asset/www/html/banda_configuracion.html");
	}
	
</script>

</head>
<body onload="onBodyLoad()">

 	 <div id="base">
	  
	 	<h1 style="height:30px;">Actualizaciones de bandas</h1>

	 	<div id="resul">
	 	  	<TABLE align="center" id="bandas">
			  <tr class="filas" id="fila">
			    <td class="celdas" id="celda" style="display:none;">COLUMNA1</td>
			  </tr>
			</TABLE>
		</div>
		
 	</div>		

</body>

</html>